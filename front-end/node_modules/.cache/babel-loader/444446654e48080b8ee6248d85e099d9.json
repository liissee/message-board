{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport { ui } from 'reducers/ui';\nconst initialState = {\n  users: [],\n  userName: localStorage.userName || \"\",\n  accessToken: localStorage.accessToken || \"\",\n  userId: localStorage.userId || \"\" // accessToken: localStorage.getItem('accessToken'),\n  // userName: localStorage.getItem('userName'),\n  // userId: localStorage.getItem('userId')\n\n};\nexport const users = createSlice({\n  name: 'user',\n  initialState,\n  reducers: {\n    setAccessToken: (state, action) => {\n      state.accessToken = action.payload;\n      window.localStorage.setItem('accessToken', action.payload);\n    },\n    removeAccessToken: (state, action) => {\n      state.accessToken = \"\";\n      window.localStorage.removeItem('accessToken', action.payload);\n    },\n    setUserId: (state, action) => {\n      state.userId = action.payload;\n      window.localStorage.setItem('userId', action.payload);\n    },\n    removeUserId: (state, action) => {\n      state.userId = \"\";\n      window.localStorage.removeItem('userId', action.payload);\n    },\n    setUserName: (state, action) => {\n      state.userName = action.payload;\n      window.localStorage.setItem('userName', action.payload);\n    },\n    removeUserName: (state, action) => {\n      state.userName = \"\";\n      window.localStorage.removeItem('userName', action.payload);\n    }\n  }\n}); //LOGIN \n\nexport const fetchUser = ({\n  userName,\n  password\n}) => {\n  return dispatch => {\n    fetch(\"http://localhost:8080/sessions\", {\n      method: 'POST',\n      body: JSON.stringify({\n        userName,\n        password\n      }),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(res => {\n      if (!res.ok) {\n        throw new Error(\"Your user name and/or password was incorrect\");\n      } else {\n        return res.json();\n      }\n    }).then(({\n      accessToken,\n      userId,\n      userName\n    }) => {\n      console.log(\"acc\", accessToken, \"id\", userId, \"name\", userName);\n\n      if (accessToken && userId && userName) {\n        dispatch(users.actions.setAccessToken(accessToken));\n        dispatch(users.actions.setUserName(userName));\n        dispatch(users.actions.setUserId(userId));\n        dispatch(ui.actions.setLoginFailed(false));\n      }\n    }).catch(err => dispatch(ui.actions.setLoginFailed(true)));\n  };\n};","map":{"version":3,"sources":["/Users/lindaisell/Desktop/technigo-bootcamp/message-board/front-end/src/reducers/users.js"],"names":["createSlice","ui","initialState","users","userName","localStorage","accessToken","userId","name","reducers","setAccessToken","state","action","payload","window","setItem","removeAccessToken","removeItem","setUserId","removeUserId","setUserName","removeUserName","fetchUser","password","dispatch","fetch","method","body","JSON","stringify","headers","then","res","ok","Error","json","console","log","actions","setLoginFailed","catch","err"],"mappings":"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","sourcesContent":["import { createSlice } from '@reduxjs/toolkit'\nimport { ui } from 'reducers/ui'\n\n\nconst initialState = {\n  users: [],\n  userName: localStorage.userName || \"\",\n  accessToken: localStorage.accessToken || \"\",\n  userId: localStorage.userId || \"\"\n  // accessToken: localStorage.getItem('accessToken'),\n  // userName: localStorage.getItem('userName'),\n  // userId: localStorage.getItem('userId')\n}\n\n\nexport const users = createSlice({\n  name: 'user',\n  initialState,\n  reducers: {\n    setAccessToken: (state, action) => {\n      state.accessToken = action.payload\n      window.localStorage.setItem('accessToken', action.payload)\n    },\n    removeAccessToken: (state, action) => {\n      state.accessToken = \"\"\n      window.localStorage.removeItem('accessToken', action.payload)\n    },\n    setUserId: (state, action) => {\n      state.userId = action.payload\n      window.localStorage.setItem('userId', action.payload)\n    },\n    removeUserId: (state, action) => {\n      state.userId = \"\"\n      window.localStorage.removeItem('userId', action.payload)\n    },\n    setUserName: (state, action) => {\n      state.userName = action.payload\n      window.localStorage.setItem('userName', action.payload)\n    },\n    removeUserName: (state, action) => {\n      state.userName = \"\"\n      window.localStorage.removeItem('userName', action.payload)\n    }\n  }\n})\n\n\n//LOGIN \nexport const fetchUser = ({ userName, password }) => {\n  return dispatch => {\n    fetch(\"http://localhost:8080/sessions\", {\n      method: 'POST',\n      body: JSON.stringify({ userName, password }),\n      headers: { 'Content-Type': 'application/json' }\n    })\n      .then(res => {\n        if (!res.ok) {\n          throw new Error(\"Your user name and/or password was incorrect\")\n        } else {\n          return res.json();\n        }\n      })\n      .then(({ accessToken, userId, userName }) => {\n        console.log(\"acc\", accessToken, \"id\", userId, \"name\", userName)\n        if (accessToken && userId && userName) {\n          dispatch(users.actions.setAccessToken(accessToken))\n          dispatch(users.actions.setUserName(userName))\n          dispatch(users.actions.setUserId(userId))\n          dispatch(ui.actions.setLoginFailed(false))\n        }\n\n      })\n      .catch(err => dispatch(ui.actions.setLoginFailed(true)))\n  }\n}\n"]},"metadata":{},"sourceType":"module"}